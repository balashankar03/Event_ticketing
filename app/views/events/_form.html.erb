<div style="max-width: 600px; margin: 40px auto; padding: 40px; border: 1px solid #e1e4e8; border-radius: 16px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background-color: #fff; color: #333;">
  
  <h1 style="text-align: center; color: #1a1a1a; margin-bottom: 30px; font-size: 1.75rem; font-weight: 800; letter-spacing: -0.5px;"> <%= event.persisted? ? "Edit Event" : "Create New Event" %></h1>

  <%= form_with model: event do |f| %>
    <% if event.errors.any? %>
    <div id="error_explanation" style="color: red; border: 1px solid red; padding: 10px; margin-bottom: 20px;">
      <h2><%= pluralize(event.errors.count, "error") %> prohibited this event from being saved:</h2>
      <ul>
        <% event.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>
    
    <section style="margin-bottom: 30px;">
      <div style="margin-bottom: 20px;">
        <%= f.label :name, style: "display: block; margin-bottom: 8px; font-weight: 600; font-size: 0.9rem;" %>
        <%= f.text_field :name, placeholder: "e.g. Summer Music Festival", style: "width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px; box-sizing: border-box; font-size: 1rem;" %>
      </div>

      <div style="margin-bottom: 20px;">
        <%= f.label :description, style: "display: block; margin-bottom: 8px; font-weight: 600; font-size: 0.9rem;" %>
        <%= f.text_area :description, rows: 3, placeholder: "Tell guests what to expect...", style: "width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px; box-sizing: border-box; font-family: inherit; font-size: 1rem;" %>
      </div>

      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
        <div>
          <%= f.label :datetime, "Date and Time", style: "display: block; margin-bottom: 8px; font-weight: 600; font-size: 0.9rem;" %>
          <%= f.datetime_field :datetime, style: "width: 100%; padding: 11px; border: 1px solid #d1d5db; border-radius: 8px; box-sizing: border-box; font-size: 0.9rem;" %>
        </div>
        <div>
          <%= f.label :image, "Event Banner", style: "display: block; margin-bottom: 8px; font-weight: 600; font-size: 0.9rem;" %>
          <%= f.file_field :image, accept: 'image/png,image/gif,image/jpeg', style: "font-size: 0.8rem; margin-top: 5px;" %>
        </div>
      </div>
    </section>
    
     <div style="position: relative; text-align: center; margin: 25px 0;">
        <span style="background: #f8fafc; padding: 0 15px; color: #94a3b8; font-size: 0.75rem; font-weight: bold; text-transform: uppercase; letter-spacing: 1px;">New Venue Details</span>
        <div style="position: absolute; top: 50%; left: 0; right: 0; border-top: 1px solid #e2e8f0; z-index: -1;"></div>
      </div>

      <div style="margin-bottom: 25px; padding: 20px; border: 1px solid #e1e4e8; border-radius: 12px; background-color: #fff;">
      <label style="display: block; margin-bottom: 12px; font-weight: bold; font-size: 0.95rem; color: #333;">
      Event Categories <span style="font-weight: normal; color: #666; font-size: 0.8rem;">(Select all that apply)</span>
      </label>

      <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 12px;">
        <%= f.collection_check_boxes :category_ids, Category.all, :id, :name do |cb| %>
        <div style="display: flex; align-items: center; background: #f8fafc; padding: 8px 12px; border-radius: 6px; border: 1px solid #edf2f7; cursor: pointer;">
        <%= cb.check_box style: "margin-right: 10px; cursor: pointer; width: 16px; height: 16px;" %>
        <%= cb.label style: "cursor: pointer; font-size: 0.85rem; color: #4a5568; user-select: none;" %>
      </div>
      <% end %>
      </div>
    </div>


    <hr style="border: 0; border-top: 1px solid #eee; margin: 30px 0;">

    <div style="background-color: #f8fafc; padding: 25px; border-radius: 12px; border: 1px solid #e2e8f0; margin-bottom: 30px;">
      <h3 style="margin-top: 0; margin-bottom: 15px; font-size: 1rem; color: #475569; display: flex; align-items: center; gap: 8px;">
        üìç Venue Information
      </h3>
      
      <div style="margin-bottom: 20px;">
        <%= f.label :venue_id, "Select an existing venue", style: "display: block; margin-bottom: 6px; font-weight: 600; font-size: 0.85rem; color: #64748b;" %>
        <%= f.collection_select :venue_id, Venue.all, :id, :name, {include_blank: "‚Äî Or create a new venue below ‚Äî"}, {style: "width: 100%; padding: 10px; border: 1px solid #cbd5e1; border-radius: 8px; background: white; cursor: pointer;"} %>
      </div>



      <%= fields_for :venue, venue do |v| %>
        <div style="margin-bottom: 15px;">
          <%= v.text_field :name, placeholder: "New Venue Name", style: "width: 100%; padding: 10px; border: 1px solid #cbd5e1; border-radius: 8px; box-sizing: border-box;" %>
        </div>

        <div style="margin-bottom: 15px;">
          <%= v.text_field :address, placeholder: "Street Address", style: "width: 100%; padding: 10px; border: 1px solid #cbd5e1; border-radius: 8px; box-sizing: border-box;" %>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
          <%= v.number_field :capacity, placeholder: "Capacity", style: "width: 100%; padding: 10px; border: 1px solid #cbd5e1; border-radius: 8px; box-sizing: border-box;" %>
          <%= v.text_field :city, placeholder: "City", style: "width: 100%; padding: 10px; border: 1px solid #cbd5e1; border-radius: 8px; box-sizing: border-box;" %>
        </div>
      <% end %>
    </div>

    <div style="margin-bottom: 35px;">
      <h3 style="margin-bottom: 15px; font-size: 1rem; color: #475569; display: flex; align-items: center; gap: 8px;">
        üéüÔ∏è Ticket Tiers
      </h3>
      
      <div id="ticket-tiers-container">
        <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 10px; margin-bottom: 8px; padding-left: 5px;">
          <span style="font-size: 0.75rem; font-weight: bold; color: #94a3b8; text-transform: uppercase;">Tier Name</span>
          <span style="font-size: 0.75rem; font-weight: bold; color: #94a3b8; text-transform: uppercase;">Price ($)</span>
          <span style="font-size: 0.75rem; font-weight: bold; color: #94a3b8; text-transform: uppercase;">Qty</span>
        </div>

        <%= f.fields_for :ticket_tiers do |tier_form| %>
          <div class="tier-fields" style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 10px; margin-bottom: 12px;">
            <%= tier_form.text_field :name, placeholder: "e.g. VIP", style: "width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 8px; box-sizing: border-box;" %>
            <%= tier_form.number_field :price, placeholder: "0.00", style: "width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 8px; box-sizing: border-box;" %>
            <%= tier_form.number_field :remaining, placeholder: "100", style: "width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 8px; box-sizing: border-box;" %>
          </div>
        <% end %>
      </div>
    </div>

    <%= f.submit (event.persisted? ? "Save Changes" : "Create Event"), style: "width: 100%; padding: 16px; background-color: #10b981; color: white; border: none; border-radius: 8px; font-weight: 700; font-size: 1.1rem; cursor: pointer; transition: background-color 0.2s; box-shadow: 0 4px 6px -1px rgba(16, 185, 129, 0.2);" %>
    <p style="text-align: center; margin-top: 20px; font-size: 0.85rem; color: #64748b;">
      All fields are required unless marked otherwise.
    </p>
  <% end %>

</div>